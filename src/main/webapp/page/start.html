<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!-- saved from url=(0070)http://web.mit.edu/jhawk/mnt/spo/git/git-doc/technical/api-config.html -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="generator" content="AsciiDoc 8.6.9" />
		<title>ConfigCenter</title>
		<link rel="stylesheet" href="../css/style.css" type="text/css" />
		<script src="../js/main.js"></script>
		<style id="style-1-cropbar-clipper">/* Copyright 2014 Evernote Corporation. All rights reserved. */
			.en-markup-crop-options {
			    top: 18px !important;
			    left: 50% !important;
			    margin-left: -100px !important;
			    width: 200px !important;
			    border: 2px rgba(255,255,255,.38) solid !important;
			    border-radius: 4px !important;
			}
			
			.en-markup-crop-options div div:first-of-type {
			    margin-left: 0px !important;
			}
		</style>
	</head>
	<body class="article">
	<div id="header">
		<h1>ConfigCenter使用</h1>
	</div>
	<p align="right"><a href="../index.html">返回首页</a></p>
	<div id="content">
		<div id="preamble">
			<div class="sectionbody">
				<div class="paragraph">
					<p>ConfigCenter使用示例代码如下<font color="red">（红色为需填入部分，其他为固定写法）</font>：<br/> <br/>
					<p>1.简易应用：只调用"获取配置项值API"即可，传入参数：配置资源名（如"redis"），配置项名（如"ip"）</p>
					<div class="listingblock">
						<div class="content">
							<dd><code>String <font color="red">redisIp</font> = ConfigCenter.getInstance().<a href="../page/api_getDataSource.html">getDataSource(<font color="red">"redis"</font>).getProperty(<font color="red">"ip"</font>)</a>;</code></dd>
						</div>
					</div>
				</div><br/>
				<div class="paragraph">
				<p>2.最复杂应用，调用配置中心所有API：<font color="red">(设置类API一定要在程序<strong><font color="red">首次</font></strong>调用ConfigCenter.getInstance()后执行，否则设置无效)</font><br/>
				 </p>
					<div class="listingblock">
						<div class="content">
							<dd><code><font color="green" size="2">// ① 设置类API，如指定服务名、调度参数等</font><br/>ConfigCenter.getInstance().<a href="../page/api_setScheduler.html">setScheduler(<font color="red">1000*60, 1000*60, false</font>)</a>.<a href="../page/api_setEnv.html">setEnv("<font color="red">springbootdemo</font>")</a>.<a href="../page/api_setDataSourceType.html">setDataSourceType('<font color="red">0</font>')</a>;<br/><br/>
							<font color="green" size="2">// ② 初始化API，如初始化配置、动态开关</font><br/>ConfigCenter.getInstance().<a href="../page/api_initConfig.html">initConfig()</a>.<a href="../page/api_initSwitch.html">initSwitch()</a>;<br/><br/>
							<font color="green" size="2">// ③ 获取配置项值API，如获取配置资源"redis"的配置项值"ip"</font><br/>String <font color="red">redisIp</font> = ConfigCenter.getInstance().<a href="../page/api_getDataSource.html">getDataSource(<font color="red">"redis"</font>).getProperty(<font color="red">"ip"</font>)</a>;<br/><br/>
							<font color="green" size="2">// ④ 动态开关API，如获取省分"11"，地市"0010"的开关状态</font><br/>boolean <font color="red">switchFlag</font> = ConfigCenter.getInstance().<a href="../page/api_isOpenSwitch.html">isOpenSwitch("<font color="red">11</font>", "<font color="red">0010</font>")</a>;<br/>
							String <font color="red">serviceName</font> = ConfigCenter.getInstance().<a href="../page/api_switchService.html">switchService("<font color="red">11</font>", "<font color="red">0010</font>", "<font color="red">crm_userinfo</font>", "<font color="red">crm_userinfojdbc</font>")</a>;<br/><br/>
							<font color="green" size="2">// ⑤ 配置资源监听器API，如检测redis集群信息变化后，重建redis数据库连接</font><br/>ConfigCenter.getInstance().<a href="../page/api_addSourceListener.html">addSourceListener("<font color="red">redis</font>",()-> {</a><br/><font color="red">
							&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("检测redis集群信息变化，开始重建redis数据库连接...");<br/>
							&nbsp;&nbsp;&nbsp;&nbsp;String redisIp = ConfigCenter.getInstance().getDataSource("redis").getProperty("ip");<br/>
							&nbsp;&nbsp;&nbsp;&nbsp;...<br/></font>
							});
							</code></dd>
						</div>
					</div>
				</div>
			</div>
		</div>
		
<div id="footer">
<div id="footer-text">
Last updated
 2017-08-30 17:38:58 EDT
</div>
</div>


</body></html>